#include "nmtools/array/index/compute_offset.hpp"
#include "nmtools/testing/data/index/compute_offset.hpp"
#include "nmtools/testing/doctest.hpp"

#define COMPUTE_OFFSET_SUBCASE(case_name, ...) \
SUBCASE(#case_name) \
{ \
    NMTOOLS_TESTING_DECLARE_NS(index, compute_offset, case_name); \
    using namespace args; \
    auto offset = nmtools::index::compute_offset(__VA_ARGS__); \
    NMTOOLS_ASSERT_EQUAL_MSG_ATTRIBUTES( offset, expect::result, __VA_ARGS__ ); \
}

TEST_CASE("compute_offset(case1a)" * doctest::test_suite("index::compute_offset"))
{
    COMPUTE_OFFSET_SUBCASE(case1a,   strides,    indices);
    COMPUTE_OFFSET_SUBCASE(case1a,  strides_a,  indices_a);
    COMPUTE_OFFSET_SUBCASE(case1a,  strides_f,  indices_f);
    COMPUTE_OFFSET_SUBCASE(case1a,  strides_h,  indices_h);
    COMPUTE_OFFSET_SUBCASE(case1a,  strides_v,  indices_v);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_ct, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_cl, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1a, strides, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1a, strides, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1a, strides, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1a, strides, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1a, strides, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1a, strides, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_a, indices);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_a, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_a, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_a, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_a, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_a, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_f, indices);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_f, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_f, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_f, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_f, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_f, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_h, indices);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_h, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_h, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_h, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_h, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_h, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_v, indices);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_v, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_v, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_v, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_v, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_v, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_ct, indices);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_ct, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_ct, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_ct, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_ct, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_ct, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_cl, indices);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_cl, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_cl, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_cl, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_cl, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_cl, indices_ct);

    COMPUTE_OFFSET_SUBCASE(case1a, m_strides_a, m_indices_a);
    COMPUTE_OFFSET_SUBCASE(case1a, m_strides_f, m_indices_f);
    COMPUTE_OFFSET_SUBCASE(case1a, m_strides_h, m_indices_h);
    COMPUTE_OFFSET_SUBCASE(case1a, m_strides_v, m_indices_v);

    COMPUTE_OFFSET_SUBCASE(case1a, strides_a, m_indices_a);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_f, m_indices_f);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_h, m_indices_h);
    COMPUTE_OFFSET_SUBCASE(case1a, strides_v, m_indices_v);

    COMPUTE_OFFSET_SUBCASE(case1a, m_strides_a, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1a, m_strides_f, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1a, m_strides_h, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1a, m_strides_v, indices_v);
}

TEST_CASE("compute_offset(case1b)" * doctest::test_suite("index::compute_offset"))
{
    COMPUTE_OFFSET_SUBCASE(case1b,   strides,    indices);
    COMPUTE_OFFSET_SUBCASE(case1b,  strides_a,  indices_a);
    COMPUTE_OFFSET_SUBCASE(case1b,  strides_f,  indices_f);
    COMPUTE_OFFSET_SUBCASE(case1b,  strides_h,  indices_h);
    COMPUTE_OFFSET_SUBCASE(case1b,  strides_v,  indices_v);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_ct, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_cl, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1b, strides, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1b, strides, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1b, strides, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1b, strides, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1b, strides, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1b, strides, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_a, indices);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_a, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_a, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_a, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_a, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_a, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_f, indices);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_f, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_f, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_f, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_f, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_f, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_h, indices);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_h, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_h, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_h, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_h, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_h, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_v, indices);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_v, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_v, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_v, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_v, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_v, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_ct, indices);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_ct, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_ct, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_ct, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_ct, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_ct, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_cl, indices);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_cl, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_cl, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_cl, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_cl, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1b, strides_cl, indices_ct);
}

TEST_CASE("compute_offset(case1c)" * doctest::test_suite("index::compute_offset"))
{
    COMPUTE_OFFSET_SUBCASE(case1c,   strides,    indices);
    COMPUTE_OFFSET_SUBCASE(case1c,  strides_a,  indices_a);
    COMPUTE_OFFSET_SUBCASE(case1c,  strides_f,  indices_f);
    COMPUTE_OFFSET_SUBCASE(case1c,  strides_h,  indices_h);
    COMPUTE_OFFSET_SUBCASE(case1c,  strides_v,  indices_v);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_ct, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_cl, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1c, strides, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1c, strides, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1c, strides, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1c, strides, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1c, strides, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1c, strides, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_a, indices);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_a, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_a, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_a, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_a, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_a, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_f, indices);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_f, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_f, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_f, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_f, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_f, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_h, indices);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_h, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_h, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_h, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_h, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_h, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_v, indices);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_v, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_v, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_v, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_v, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_v, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_ct, indices);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_ct, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_ct, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_ct, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_ct, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_ct, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_cl, indices);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_cl, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_cl, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_cl, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_cl, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1c, strides_cl, indices_ct);
}

TEST_CASE("compute_offset(case1d)" * doctest::test_suite("index::compute_offset"))
{
    COMPUTE_OFFSET_SUBCASE(case1d,   strides,    indices);
    COMPUTE_OFFSET_SUBCASE(case1d,  strides_a,  indices_a);
    COMPUTE_OFFSET_SUBCASE(case1d,  strides_f,  indices_f);
    COMPUTE_OFFSET_SUBCASE(case1d,  strides_h,  indices_h);
    COMPUTE_OFFSET_SUBCASE(case1d,  strides_v,  indices_v);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_ct, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_cl, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1d, strides, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1d, strides, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1d, strides, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1d, strides, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1d, strides, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1d, strides, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_a, indices);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_a, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_a, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_a, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_a, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_a, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_f, indices);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_f, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_f, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_f, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_f, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_f, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_h, indices);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_h, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_h, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_h, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_h, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_h, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_v, indices);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_v, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_v, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_v, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_v, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_v, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_ct, indices);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_ct, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_ct, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_ct, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_ct, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_ct, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_cl, indices);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_cl, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_cl, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_cl, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_cl, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1d, strides_cl, indices_ct);
}

TEST_CASE("compute_offset(case1e)" * doctest::test_suite("index::compute_offset"))
{
    COMPUTE_OFFSET_SUBCASE(case1e,   strides,    indices);
    COMPUTE_OFFSET_SUBCASE(case1e,  strides_a,  indices_a);
    COMPUTE_OFFSET_SUBCASE(case1e,  strides_f,  indices_f);
    COMPUTE_OFFSET_SUBCASE(case1e,  strides_h,  indices_h);
    COMPUTE_OFFSET_SUBCASE(case1e,  strides_v,  indices_v);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_ct, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_cl, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1e, strides, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1e, strides, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1e, strides, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1e, strides, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1e, strides, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1e, strides, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_a, indices);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_a, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_a, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_a, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_a, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_a, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_f, indices);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_f, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_f, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_f, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_f, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_f, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_h, indices);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_h, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_h, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_h, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_h, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_h, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_v, indices);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_v, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_v, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_v, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_v, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_v, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_ct, indices);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_ct, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_ct, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_ct, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_ct, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_ct, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_cl, indices);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_cl, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_cl, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_cl, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_cl, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1e, strides_cl, indices_ct);
}

TEST_CASE("compute_offset(case1f)" * doctest::test_suite("index::compute_offset"))
{
    COMPUTE_OFFSET_SUBCASE(case1f,   strides,    indices);
    COMPUTE_OFFSET_SUBCASE(case1f,  strides_a,  indices_a);
    COMPUTE_OFFSET_SUBCASE(case1f,  strides_f,  indices_f);
    COMPUTE_OFFSET_SUBCASE(case1f,  strides_h,  indices_h);
    COMPUTE_OFFSET_SUBCASE(case1f,  strides_v,  indices_v);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_ct, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_cl, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1f, strides, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1f, strides, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1f, strides, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1f, strides, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1f, strides, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1f, strides, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_a, indices);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_a, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_a, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_a, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_a, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_a, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_f, indices);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_f, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_f, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_f, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_f, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_f, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_h, indices);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_h, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_h, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_h, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_h, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_h, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_v, indices);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_v, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_v, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_v, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_v, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_v, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_ct, indices);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_ct, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_ct, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_ct, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_ct, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_ct, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_cl, indices);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_cl, indices_a);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_cl, indices_f);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_cl, indices_h);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_cl, indices_v);
    COMPUTE_OFFSET_SUBCASE(case1f, strides_cl, indices_ct);
}

TEST_CASE("compute_offset(case2a)" * doctest::test_suite("index::compute_offset"))
{
    COMPUTE_OFFSET_SUBCASE(case2a,   strides,    indices);
    COMPUTE_OFFSET_SUBCASE(case2a,  strides_a,  indices_a);
    COMPUTE_OFFSET_SUBCASE(case2a,  strides_f,  indices_f);
    COMPUTE_OFFSET_SUBCASE(case2a,  strides_h,  indices_h);
    COMPUTE_OFFSET_SUBCASE(case2a,  strides_v,  indices_v);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_ct, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_cl, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2a, strides, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2a, strides, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2a, strides, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2a, strides, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2a, strides, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2a, strides, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_a, indices);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_a, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_a, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_a, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_a, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_a, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_f, indices);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_f, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_f, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_f, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_f, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_f, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_h, indices);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_h, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_h, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_h, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_h, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_h, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_v, indices);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_v, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_v, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_v, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_v, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_v, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_ct, indices);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_ct, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_ct, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_ct, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_ct, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_ct, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_cl, indices);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_cl, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_cl, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_cl, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_cl, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2a, strides_cl, indices_ct);
}

TEST_CASE("compute_offset(case2b)" * doctest::test_suite("index::compute_offset"))
{
    COMPUTE_OFFSET_SUBCASE(case2b,   strides,    indices);
    COMPUTE_OFFSET_SUBCASE(case2b,  strides_a,  indices_a);
    COMPUTE_OFFSET_SUBCASE(case2b,  strides_f,  indices_f);
    COMPUTE_OFFSET_SUBCASE(case2b,  strides_h,  indices_h);
    COMPUTE_OFFSET_SUBCASE(case2b,  strides_v,  indices_v);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_ct, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_cl, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2b, strides, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2b, strides, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2b, strides, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2b, strides, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2b, strides, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2b, strides, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_a, indices);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_a, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_a, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_a, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_a, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_a, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_f, indices);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_f, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_f, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_f, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_f, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_f, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_h, indices);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_h, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_h, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_h, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_h, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_h, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_v, indices);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_v, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_v, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_v, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_v, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_v, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_ct, indices);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_ct, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_ct, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_ct, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_ct, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_ct, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_cl, indices);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_cl, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_cl, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_cl, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_cl, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2b, strides_cl, indices_ct);
}

TEST_CASE("compute_offset(case2c)" * doctest::test_suite("index::compute_offset"))
{
    COMPUTE_OFFSET_SUBCASE(case2c,   strides,    indices);
    COMPUTE_OFFSET_SUBCASE(case2c,  strides_a,  indices_a);
    COMPUTE_OFFSET_SUBCASE(case2c,  strides_f,  indices_f);
    COMPUTE_OFFSET_SUBCASE(case2c,  strides_h,  indices_h);
    COMPUTE_OFFSET_SUBCASE(case2c,  strides_v,  indices_v);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_ct, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_cl, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2c, strides, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2c, strides, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2c, strides, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2c, strides, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2c, strides, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2c, strides, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_a, indices);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_a, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_a, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_a, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_a, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_a, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_f, indices);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_f, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_f, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_f, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_f, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_f, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_h, indices);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_h, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_h, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_h, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_h, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_h, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_v, indices);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_v, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_v, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_v, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_v, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_v, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_ct, indices);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_ct, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_ct, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_ct, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_ct, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_ct, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_cl, indices);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_cl, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_cl, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_cl, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_cl, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2c, strides_cl, indices_ct);
}

TEST_CASE("compute_offset(case2d)" * doctest::test_suite("index::compute_offset"))
{
    COMPUTE_OFFSET_SUBCASE(case2d,   strides,    indices);
    COMPUTE_OFFSET_SUBCASE(case2d,  strides_a,  indices_a);
    COMPUTE_OFFSET_SUBCASE(case2d,  strides_f,  indices_f);
    COMPUTE_OFFSET_SUBCASE(case2d,  strides_h,  indices_h);
    COMPUTE_OFFSET_SUBCASE(case2d,  strides_v,  indices_v);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_ct, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_cl, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2d, strides, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2d, strides, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2d, strides, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2d, strides, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2d, strides, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2d, strides, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_a, indices);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_a, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_a, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_a, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_a, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_a, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_f, indices);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_f, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_f, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_f, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_f, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_f, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_h, indices);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_h, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_h, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_h, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_h, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_h, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_v, indices);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_v, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_v, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_v, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_v, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_v, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_ct, indices);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_ct, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_ct, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_ct, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_ct, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_ct, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_cl, indices);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_cl, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_cl, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_cl, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_cl, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2d, strides_cl, indices_ct);
}

TEST_CASE("compute_offset(case2e)" * doctest::test_suite("index::compute_offset"))
{
    COMPUTE_OFFSET_SUBCASE(case2e,   strides,    indices);
    COMPUTE_OFFSET_SUBCASE(case2e,  strides_a,  indices_a);
    COMPUTE_OFFSET_SUBCASE(case2e,  strides_f,  indices_f);
    COMPUTE_OFFSET_SUBCASE(case2e,  strides_h,  indices_h);
    COMPUTE_OFFSET_SUBCASE(case2e,  strides_v,  indices_v);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_ct, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_cl, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2e, strides, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2e, strides, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2e, strides, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2e, strides, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2e, strides, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2e, strides, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_a, indices);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_a, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_a, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_a, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_a, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_a, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_f, indices);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_f, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_f, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_f, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_f, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_f, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_h, indices);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_h, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_h, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_h, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_h, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_h, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_v, indices);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_v, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_v, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_v, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_v, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_v, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_ct, indices);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_ct, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_ct, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_ct, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_ct, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_ct, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_cl, indices);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_cl, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_cl, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_cl, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_cl, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2e, strides_cl, indices_ct);
}

TEST_CASE("compute_offset(case2f)" * doctest::test_suite("index::compute_offset"))
{
    COMPUTE_OFFSET_SUBCASE(case2f,   strides,    indices);
    COMPUTE_OFFSET_SUBCASE(case2f,  strides_a,  indices_a);
    COMPUTE_OFFSET_SUBCASE(case2f,  strides_f,  indices_f);
    COMPUTE_OFFSET_SUBCASE(case2f,  strides_h,  indices_h);
    COMPUTE_OFFSET_SUBCASE(case2f,  strides_v,  indices_v);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_ct, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_cl, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2f, strides, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2f, strides, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2f, strides, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2f, strides, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2f, strides, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2f, strides, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_a, indices);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_a, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_a, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_a, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_a, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_a, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_f, indices);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_f, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_f, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_f, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_f, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_f, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_h, indices);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_h, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_h, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_h, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_h, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_h, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_v, indices);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_v, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_v, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_v, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_v, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_v, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_ct, indices);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_ct, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_ct, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_ct, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_ct, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_ct, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_cl, indices);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_cl, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_cl, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_cl, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_cl, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2f, strides_cl, indices_ct);
}

TEST_CASE("compute_offset(case2g)" * doctest::test_suite("index::compute_offset"))
{
    COMPUTE_OFFSET_SUBCASE(case2g,   strides,    indices);
    COMPUTE_OFFSET_SUBCASE(case2g,  strides_a,  indices_a);
    COMPUTE_OFFSET_SUBCASE(case2g,  strides_f,  indices_f);
    COMPUTE_OFFSET_SUBCASE(case2g,  strides_h,  indices_h);
    COMPUTE_OFFSET_SUBCASE(case2g,  strides_v,  indices_v);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_ct, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_cl, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2g, strides, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2g, strides, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2g, strides, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2g, strides, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2g, strides, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2g, strides, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_a, indices);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_a, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_a, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_a, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_a, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_a, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_f, indices);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_f, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_f, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_f, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_f, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_f, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_h, indices);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_h, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_h, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_h, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_h, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_h, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_v, indices);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_v, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_v, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_v, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_v, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_v, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_ct, indices);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_ct, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_ct, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_ct, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_ct, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_ct, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_cl, indices);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_cl, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_cl, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_cl, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_cl, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2g, strides_cl, indices_ct);
}

TEST_CASE("compute_offset(case2h)" * doctest::test_suite("index::compute_offset"))
{
    COMPUTE_OFFSET_SUBCASE(case2h,   strides,    indices);
    COMPUTE_OFFSET_SUBCASE(case2h,  strides_a,  indices_a);
    COMPUTE_OFFSET_SUBCASE(case2h,  strides_f,  indices_f);
    COMPUTE_OFFSET_SUBCASE(case2h,  strides_h,  indices_h);
    COMPUTE_OFFSET_SUBCASE(case2h,  strides_v,  indices_v);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_ct, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_cl, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2h, strides, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2h, strides, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2h, strides, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2h, strides, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2h, strides, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2h, strides, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_a, indices);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_a, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_a, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_a, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_a, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_a, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_f, indices);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_f, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_f, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_f, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_f, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_f, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_h, indices);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_h, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_h, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_h, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_h, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_h, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_v, indices);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_v, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_v, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_v, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_v, indices_ct);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_v, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_ct, indices);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_ct, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_ct, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_ct, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_ct, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_ct, indices_cl);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_cl, indices);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_cl, indices_a);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_cl, indices_f);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_cl, indices_h);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_cl, indices_v);
    COMPUTE_OFFSET_SUBCASE(case2h, strides_cl, indices_ct);
}