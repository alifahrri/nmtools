#ifndef NMTOOLS_TESTING_DATA_ARRAY_CONV3D_HPP
#define NMTOOLS_TESTING_DATA_ARRAY_CONV3D_HPP

#include "nmtools/testing/testing.hpp"
#include "nmtools/testing/array_cast.hpp"

NMTOOLS_TESTING_DECLARE_CASE(array,conv3d)
{
    using namespace literals;
    NMTOOLS_TESTING_DECLARE_ARGS(case1a)
    {
        inline int input[1][3][4][4][4] =
        {{{{{  0,   1,   2,   3},
            {  4,   5,   6,   7},
            {  8,   9,  10,  11},
            { 12,  13,  14,  15}},
 
           {{ 16,  17,  18,  19},
            { 20,  21,  22,  23},
            { 24,  25,  26,  27},
            { 28,  29,  30,  31}},
 
           {{ 32,  33,  34,  35},
            { 36,  37,  38,  39},
            { 40,  41,  42,  43},
            { 44,  45,  46,  47}},
 
           {{ 48,  49,  50,  51},
            { 52,  53,  54,  55},
            { 56,  57,  58,  59},
            { 60,  61,  62,  63}}},
 
 
          {{{ 64,  65,  66,  67},
            { 68,  69,  70,  71},
            { 72,  73,  74,  75},
            { 76,  77,  78,  79}},
 
           {{ 80,  81,  82,  83},
            { 84,  85,  86,  87},
            { 88,  89,  90,  91},
            { 92,  93,  94,  95}},
 
           {{ 96,  97,  98,  99},
            {100, 101, 102, 103},
            {104, 105, 106, 107},
            {108, 109, 110, 111}},
 
           {{112, 113, 114, 115},
            {116, 117, 118, 119},
            {120, 121, 122, 123},
            {124, 125, 126, 127}}},
 
 
          {{{128, 129, 130, 131},
            {132, 133, 134, 135},
            {136, 137, 138, 139},
            {140, 141, 142, 143}},
 
           {{144, 145, 146, 147},
            {148, 149, 150, 151},
            {152, 153, 154, 155},
            {156, 157, 158, 159}},
 
           {{160, 161, 162, 163},
            {164, 165, 166, 167},
            {168, 169, 170, 171},
            {172, 173, 174, 175}},
 
           {{176, 177, 178, 179},
            {180, 181, 182, 183},
            {184, 185, 186, 187},
            {188, 189, 190, 191}}}}};
        
        inline int weight[1][3][3][3][3] =
        {{{{{ 0,  1,  2},
            { 3,  4,  5},
            { 6,  7,  8}},
 
           {{ 9, 10, 11},
            {12, 13, 14},
            {15, 16, 17}},
 
           {{18, 19, 20},
            {21, 22, 23},
            {24, 25, 26}}},
 
 
          {{{27, 28, 29},
            {30, 31, 32},
            {33, 34, 35}},
 
           {{36, 37, 38},
            {39, 40, 41},
            {42, 43, 44}},
 
           {{45, 46, 47},
            {48, 49, 50},
            {51, 52, 53}}},
 
 
          {{{54, 55, 56},
            {57, 58, 59},
            {60, 61, 62}},
 
           {{63, 64, 65},
            {66, 67, 68},
            {69, 70, 71}},
 
           {{72, 73, 74},
            {75, 76, 77},
            {78, 79, 80}}}}};
        inline int bias[1] = {1};
        NMTOOLS_CAST_ARRAYS(input)
        NMTOOLS_CAST_ARRAYS(weight)
        NMTOOLS_CAST_ARRAYS(bias)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case1a)
    {
        inline float result[1][1][2][2][2] =
        {{{{{377191., 380431.},
            {390151., 393391.}},
 
           {{429031., 432271.},
            {441991., 445231.}}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case1b)
    {
      inline int input[1][3][4][4][4] =
        {{{{{  0,   1,   2,   3},
            {  4,   5,   6,   7},
            {  8,   9,  10,  11},
            { 12,  13,  14,  15}},
 
           {{ 16,  17,  18,  19},
            { 20,  21,  22,  23},
            { 24,  25,  26,  27},
            { 28,  29,  30,  31}},
 
           {{ 32,  33,  34,  35},
            { 36,  37,  38,  39},
            { 40,  41,  42,  43},
            { 44,  45,  46,  47}},
 
           {{ 48,  49,  50,  51},
            { 52,  53,  54,  55},
            { 56,  57,  58,  59},
            { 60,  61,  62,  63}}},
 
 
          {{{ 64,  65,  66,  67},
            { 68,  69,  70,  71},
            { 72,  73,  74,  75},
            { 76,  77,  78,  79}},
 
           {{ 80,  81,  82,  83},
            { 84,  85,  86,  87},
            { 88,  89,  90,  91},
            { 92,  93,  94,  95}},
 
           {{ 96,  97,  98,  99},
            {100, 101, 102, 103},
            {104, 105, 106, 107},
            {108, 109, 110, 111}},
 
           {{112, 113, 114, 115},
            {116, 117, 118, 119},
            {120, 121, 122, 123},
            {124, 125, 126, 127}}},
 
 
          {{{128, 129, 130, 131},
            {132, 133, 134, 135},
            {136, 137, 138, 139},
            {140, 141, 142, 143}},
 
           {{144, 145, 146, 147},
            {148, 149, 150, 151},
            {152, 153, 154, 155},
            {156, 157, 158, 159}},
 
           {{160, 161, 162, 163},
            {164, 165, 166, 167},
            {168, 169, 170, 171},
            {172, 173, 174, 175}},
 
           {{176, 177, 178, 179},
            {180, 181, 182, 183},
            {184, 185, 186, 187},
            {188, 189, 190, 191}}}}};
      
      inline int weight[2][3][2][2][2] =
        {{{{{ 0,  1},
            { 2,  3}},
 
           {{ 4,  5},
            { 6,  7}}},
 
 
          {{{ 8,  9},
            {10, 11}},
 
           {{12, 13},
            {14, 15}}},
 
 
          {{{16, 17},
            {18, 19}},
 
           {{20, 21},
            {22, 23}}}},
 
 
 
         {{{{24, 25},
            {26, 27}},
 
           {{28, 29},
            {30, 31}}},
 
 
          {{{32, 33},
            {34, 35}},
 
           {{36, 37},
            {38, 39}}},
 
 
          {{{40, 41},
            {42, 43}},
 
           {{44, 45},
            {46, 47}}}}};
      
      inline int bias[2] = {1,2};
      NMTOOLS_CAST_ARRAYS(input)
      NMTOOLS_CAST_ARRAYS(weight)
      NMTOOLS_CAST_ARRAYS(bias)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case1b)
    {
      inline int result[1][2][3][3][3] =
        {{{{{ 29193,  29469,  29745},
            { 30297,  30573,  30849},
            { 31401,  31677,  31953}},
 
           {{ 33609,  33885,  34161},
            { 34713,  34989,  35265},
            { 35817,  36093,  36369}},
 
           {{ 38025,  38301,  38577},
            { 39129,  39405,  39681},
            { 40233,  40509,  40785}}},
 
 
          {{{ 72106,  72958,  73810},
            { 75514,  76366,  77218},
            { 78922,  79774,  80626}},
 
           {{ 85738,  86590,  87442},
            { 89146,  89998,  90850},
            { 92554,  93406,  94258}},
 
           {{ 99370, 100222, 101074},
            {102778, 103630, 104482},
            {106186, 107038, 107890}}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case1c)
    {
      inline int input[1][3][4][4][4] =
        {{{{{  0,   1,   2,   3},
            {  4,   5,   6,   7},
            {  8,   9,  10,  11},
            { 12,  13,  14,  15}},
 
           {{ 16,  17,  18,  19},
            { 20,  21,  22,  23},
            { 24,  25,  26,  27},
            { 28,  29,  30,  31}},
 
           {{ 32,  33,  34,  35},
            { 36,  37,  38,  39},
            { 40,  41,  42,  43},
            { 44,  45,  46,  47}},
 
           {{ 48,  49,  50,  51},
            { 52,  53,  54,  55},
            { 56,  57,  58,  59},
            { 60,  61,  62,  63}}},
 
 
          {{{ 64,  65,  66,  67},
            { 68,  69,  70,  71},
            { 72,  73,  74,  75},
            { 76,  77,  78,  79}},
 
           {{ 80,  81,  82,  83},
            { 84,  85,  86,  87},
            { 88,  89,  90,  91},
            { 92,  93,  94,  95}},
 
           {{ 96,  97,  98,  99},
            {100, 101, 102, 103},
            {104, 105, 106, 107},
            {108, 109, 110, 111}},
 
           {{112, 113, 114, 115},
            {116, 117, 118, 119},
            {120, 121, 122, 123},
            {124, 125, 126, 127}}},
 
 
          {{{128, 129, 130, 131},
            {132, 133, 134, 135},
            {136, 137, 138, 139},
            {140, 141, 142, 143}},
 
           {{144, 145, 146, 147},
            {148, 149, 150, 151},
            {152, 153, 154, 155},
            {156, 157, 158, 159}},
 
           {{160, 161, 162, 163},
            {164, 165, 166, 167},
            {168, 169, 170, 171},
            {172, 173, 174, 175}},
 
           {{176, 177, 178, 179},
            {180, 181, 182, 183},
            {184, 185, 186, 187},
            {188, 189, 190, 191}}}}};
      
      inline int weight[2][3][2][2][2] =
        {{{{{ 0,  1},
            { 2,  3}},
 
           {{ 4,  5},
            { 6,  7}}},
 
 
          {{{ 8,  9},
            {10, 11}},
 
           {{12, 13},
            {14, 15}}},
 
 
          {{{16, 17},
            {18, 19}},
 
           {{20, 21},
            {22, 23}}}},
 
 
 
         {{{{24, 25},
            {26, 27}},
 
           {{28, 29},
            {30, 31}}},
 
 
          {{{32, 33},
            {34, 35}},
 
           {{36, 37},
            {38, 39}}},
 
 
          {{{40, 41},
            {42, 43}},
 
           {{44, 45},
            {46, 47}}}}};
      
      inline int bias[2] = {1,2};
      inline int stride = 2;
      inline auto stride_ct = 2_ct;
      NMTOOLS_CAST_ARRAYS(input)
      NMTOOLS_CAST_ARRAYS(weight)
      NMTOOLS_CAST_ARRAYS(bias)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case1c)
    {
      inline int result[1][2][2][2][2] =
        {{{{{ 29193,  29745},
            { 31401,  31953}},
 
           {{ 38025,  38577},
            { 40233,  40785}}},
 
 
          {{{ 72106,  73810},
            { 78922,  80626}},
 
           {{ 99370, 101074},
            {106186, 107890}}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case1d)
    {
      inline int input[1][3][4][4][4] =
        {{{{{  0,   1,   2,   3},
            {  4,   5,   6,   7},
            {  8,   9,  10,  11},
            { 12,  13,  14,  15}},
 
           {{ 16,  17,  18,  19},
            { 20,  21,  22,  23},
            { 24,  25,  26,  27},
            { 28,  29,  30,  31}},
 
           {{ 32,  33,  34,  35},
            { 36,  37,  38,  39},
            { 40,  41,  42,  43},
            { 44,  45,  46,  47}},
 
           {{ 48,  49,  50,  51},
            { 52,  53,  54,  55},
            { 56,  57,  58,  59},
            { 60,  61,  62,  63}}},
 
 
          {{{ 64,  65,  66,  67},
            { 68,  69,  70,  71},
            { 72,  73,  74,  75},
            { 76,  77,  78,  79}},
 
           {{ 80,  81,  82,  83},
            { 84,  85,  86,  87},
            { 88,  89,  90,  91},
            { 92,  93,  94,  95}},
 
           {{ 96,  97,  98,  99},
            {100, 101, 102, 103},
            {104, 105, 106, 107},
            {108, 109, 110, 111}},
 
           {{112, 113, 114, 115},
            {116, 117, 118, 119},
            {120, 121, 122, 123},
            {124, 125, 126, 127}}},
 
 
          {{{128, 129, 130, 131},
            {132, 133, 134, 135},
            {136, 137, 138, 139},
            {140, 141, 142, 143}},
 
           {{144, 145, 146, 147},
            {148, 149, 150, 151},
            {152, 153, 154, 155},
            {156, 157, 158, 159}},
 
           {{160, 161, 162, 163},
            {164, 165, 166, 167},
            {168, 169, 170, 171},
            {172, 173, 174, 175}},
 
           {{176, 177, 178, 179},
            {180, 181, 182, 183},
            {184, 185, 186, 187},
            {188, 189, 190, 191}}}}};
      
      inline int weight[6][1][2][2][2] =
        {{{{{ 0,  1},
            { 2,  3}},
 
           {{ 4,  5},
            { 6,  7}}}},
 
 
 
         {{{{ 8,  9},
            {10, 11}},
 
           {{12, 13},
            {14, 15}}}},
 
 
 
         {{{{16, 17},
            {18, 19}},
 
           {{20, 21},
            {22, 23}}}},
 
 
 
         {{{{24, 25},
            {26, 27}},
 
           {{28, 29},
            {30, 31}}}},
 
 
 
         {{{{32, 33},
            {34, 35}},
 
           {{36, 37},
            {38, 39}}}},
 
 
 
         {{{{40, 41},
            {42, 43}},
 
           {{44, 45},
            {46, 47}}}}};
      
      inline int bias[6] = {0,1,2,3,4,5};
      inline int stride = 2;
      inline int groups = 3;
      inline auto stride_ct = 2_ct;
      inline auto groups_ct = 3_ct;
      NMTOOLS_CAST_ARRAYS(input)
      NMTOOLS_CAST_ARRAYS(weight)
      NMTOOLS_CAST_ARRAYS(bias)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case1d)
    {
      inline int result[1][6][2][2][2] =
        {{{{{  440,   496},
            {  664,   720}},
 
           {{ 1336,  1392},
            { 1560,  1616}}},
 
 
          {{{ 1113,  1297},
            { 1849,  2033}},
 
           {{ 4057,  4241},
            { 4793,  4977}}},
 
 
          {{{11770, 12082},
            {13018, 13330}},
 
           {{16762, 17074},
            {18010, 18322}}},
 
 
          {{{16539, 16979},
            {18299, 18739}},
 
           {{23579, 24019},
            {25339, 25779}}},
 
 
          {{{39484, 40052},
            {41756, 42324}},
 
           {{48572, 49140},
            {50844, 51412}}},
 
 
          {{{48349, 49045},
            {51133, 51829}},
 
           {{59485, 60181},
            {62269, 62965}}}}};
    }
    
    NMTOOLS_TESTING_DECLARE_ARGS(case1e)
    {
      inline int input[1][3][2][3][4] =
      {{{{{ 0,  1,  2,  3},
          { 4,  5,  6,  7},
          { 8,  9, 10, 11}},
 
         {{12, 13, 14, 15},
          {16, 17, 18, 19},
          {20, 21, 22, 23}}},
 
 
        {{{24, 25, 26, 27},
          {28, 29, 30, 31},
          {32, 33, 34, 35}},
 
         {{36, 37, 38, 39},
          {40, 41, 42, 43},
          {44, 45, 46, 47}}},
 
 
        {{{48, 49, 50, 51},
          {52, 53, 54, 55},
          {56, 57, 58, 59}},
 
         {{60, 61, 62, 63},
          {64, 65, 66, 67},
          {68, 69, 70, 71}}}}};
      inline int weight[6][1][2][2][2] =
        {{{{{ 0,  1},
            { 2,  3}},
 
           {{ 4,  5},
            { 6,  7}}}},
 
 
 
         {{{{ 8,  9},
            {10, 11}},
 
           {{12, 13},
            {14, 15}}}},
 
 
 
         {{{{16, 17},
            {18, 19}},
 
           {{20, 21},
            {22, 23}}}},
 
 
 
         {{{{24, 25},
            {26, 27}},
 
           {{28, 29},
            {30, 31}}}},
 
 
 
         {{{{32, 33},
            {34, 35}},
 
           {{36, 37},
            {38, 39}}}},
 
 
 
         {{{{40, 41},
            {42, 43}},
 
           {{44, 45},
            {46, 47}}}}};
      inline int bias[6] = {0,1,2,3,4,5};
      inline int stride = 2;
      inline int groups = 3;
      inline auto stride_ct = 2_ct;
      inline auto groups_ct = 3_ct;
      NMTOOLS_CAST_ARRAYS(input)
      NMTOOLS_CAST_ARRAYS(weight)
      NMTOOLS_CAST_ARRAYS(bias)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case1e)
    {
      inline int result[1][6][1][1][2] =
      {{{{{  352,   408}}},
 
 
        {{{  897,  1081}}},
 
 
        {{{ 5186,  5498}}},
 
 
        {{{ 7267,  7707}}},
 
 
        {{{16164, 16732}}},
 
 
        {{{19781, 20477}}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case1f)
    {
      inline int input[1][3][4][4][4] =
        {{{{{  0,   1,   2,   3},
            {  4,   5,   6,   7},
            {  8,   9,  10,  11},
            { 12,  13,  14,  15}},
 
           {{ 16,  17,  18,  19},
            { 20,  21,  22,  23},
            { 24,  25,  26,  27},
            { 28,  29,  30,  31}},
 
           {{ 32,  33,  34,  35},
            { 36,  37,  38,  39},
            { 40,  41,  42,  43},
            { 44,  45,  46,  47}},
 
           {{ 48,  49,  50,  51},
            { 52,  53,  54,  55},
            { 56,  57,  58,  59},
            { 60,  61,  62,  63}}},
 
 
          {{{ 64,  65,  66,  67},
            { 68,  69,  70,  71},
            { 72,  73,  74,  75},
            { 76,  77,  78,  79}},
 
           {{ 80,  81,  82,  83},
            { 84,  85,  86,  87},
            { 88,  89,  90,  91},
            { 92,  93,  94,  95}},
 
           {{ 96,  97,  98,  99},
            {100, 101, 102, 103},
            {104, 105, 106, 107},
            {108, 109, 110, 111}},
 
           {{112, 113, 114, 115},
            {116, 117, 118, 119},
            {120, 121, 122, 123},
            {124, 125, 126, 127}}},
 
 
          {{{128, 129, 130, 131},
            {132, 133, 134, 135},
            {136, 137, 138, 139},
            {140, 141, 142, 143}},
 
           {{144, 145, 146, 147},
            {148, 149, 150, 151},
            {152, 153, 154, 155},
            {156, 157, 158, 159}},
 
           {{160, 161, 162, 163},
            {164, 165, 166, 167},
            {168, 169, 170, 171},
            {172, 173, 174, 175}},
 
           {{176, 177, 178, 179},
            {180, 181, 182, 183},
            {184, 185, 186, 187},
            {188, 189, 190, 191}}}}};
      
      inline int weight[6][1][2][2][2] =
        {{{{{ 0,  1},
            { 2,  3}},
 
           {{ 4,  5},
            { 6,  7}}}},
 
 
 
         {{{{ 8,  9},
            {10, 11}},
 
           {{12, 13},
            {14, 15}}}},
 
 
 
         {{{{16, 17},
            {18, 19}},
 
           {{20, 21},
            {22, 23}}}},
 
 
 
         {{{{24, 25},
            {26, 27}},
 
           {{28, 29},
            {30, 31}}}},
 
 
 
         {{{{32, 33},
            {34, 35}},
 
           {{36, 37},
            {38, 39}}}},
 
 
 
         {{{{40, 41},
            {42, 43}},
 
           {{44, 45},
            {46, 47}}}}};
      
      inline int bias[6] = {0,1,2,3,4,5};
      inline int groups = 3;
      inline auto groups_ct = 3_ct;
      NMTOOLS_CAST_ARRAYS(input)
      NMTOOLS_CAST_ARRAYS(weight)
      NMTOOLS_CAST_ARRAYS(bias)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case1f)
    {
      inline int result[1][6][3][3][3] =
      {{{{{  440,   468,   496},
          {  552,   580,   608},
          {  664,   692,   720}},
 
         {{  888,   916,   944},
          { 1000,  1028,  1056},
          { 1112,  1140,  1168}},
 
         {{ 1336,  1364,  1392},
          { 1448,  1476,  1504},
          { 1560,  1588,  1616}}},
 
 
        {{{ 1113,  1205,  1297},
          { 1481,  1573,  1665},
          { 1849,  1941,  2033}},
 
         {{ 2585,  2677,  2769},
          { 2953,  3045,  3137},
          { 3321,  3413,  3505}},
 
         {{ 4057,  4149,  4241},
          { 4425,  4517,  4609},
          { 4793,  4885,  4977}}},
 
 
        {{{11770, 11926, 12082},
          {12394, 12550, 12706},
          {13018, 13174, 13330}},
 
         {{14266, 14422, 14578},
          {14890, 15046, 15202},
          {15514, 15670, 15826}},
 
         {{16762, 16918, 17074},
          {17386, 17542, 17698},
          {18010, 18166, 18322}}},
 
 
        {{{16539, 16759, 16979},
          {17419, 17639, 17859},
          {18299, 18519, 18739}},
 
         {{20059, 20279, 20499},
          {20939, 21159, 21379},
          {21819, 22039, 22259}},
 
         {{23579, 23799, 24019},
          {24459, 24679, 24899},
          {25339, 25559, 25779}}},
 
 
        {{{39484, 39768, 40052},
          {40620, 40904, 41188},
          {41756, 42040, 42324}},
 
         {{44028, 44312, 44596},
          {45164, 45448, 45732},
          {46300, 46584, 46868}},
 
         {{48572, 48856, 49140},
          {49708, 49992, 50276},
          {50844, 51128, 51412}}},
 
 
        {{{48349, 48697, 49045},
          {49741, 50089, 50437},
          {51133, 51481, 51829}},
 
         {{53917, 54265, 54613},
          {55309, 55657, 56005},
          {56701, 57049, 57397}},
 
         {{59485, 59833, 60181},
          {60877, 61225, 61573},
          {62269, 62617, 62965}}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case1g)
    {
      inline int input[1][3][4][4][4] =
        {{{{{  0,   1,   2,   3},
            {  4,   5,   6,   7},
            {  8,   9,  10,  11},
            { 12,  13,  14,  15}},
 
           {{ 16,  17,  18,  19},
            { 20,  21,  22,  23},
            { 24,  25,  26,  27},
            { 28,  29,  30,  31}},
 
           {{ 32,  33,  34,  35},
            { 36,  37,  38,  39},
            { 40,  41,  42,  43},
            { 44,  45,  46,  47}},
 
           {{ 48,  49,  50,  51},
            { 52,  53,  54,  55},
            { 56,  57,  58,  59},
            { 60,  61,  62,  63}}},
 
 
          {{{ 64,  65,  66,  67},
            { 68,  69,  70,  71},
            { 72,  73,  74,  75},
            { 76,  77,  78,  79}},
 
           {{ 80,  81,  82,  83},
            { 84,  85,  86,  87},
            { 88,  89,  90,  91},
            { 92,  93,  94,  95}},
 
           {{ 96,  97,  98,  99},
            {100, 101, 102, 103},
            {104, 105, 106, 107},
            {108, 109, 110, 111}},
 
           {{112, 113, 114, 115},
            {116, 117, 118, 119},
            {120, 121, 122, 123},
            {124, 125, 126, 127}}},
 
 
          {{{128, 129, 130, 131},
            {132, 133, 134, 135},
            {136, 137, 138, 139},
            {140, 141, 142, 143}},
 
           {{144, 145, 146, 147},
            {148, 149, 150, 151},
            {152, 153, 154, 155},
            {156, 157, 158, 159}},
 
           {{160, 161, 162, 163},
            {164, 165, 166, 167},
            {168, 169, 170, 171},
            {172, 173, 174, 175}},
 
           {{176, 177, 178, 179},
            {180, 181, 182, 183},
            {184, 185, 186, 187},
            {188, 189, 190, 191}}}}};
      
      inline int weight[3][1][2][2][2] =
        {{{{{ 0,  1},
            { 2,  3}},
 
           {{ 4,  5},
            { 6,  7}}}},
 
 
 
         {{{{ 8,  9},
            {10, 11}},
 
           {{12, 13},
            {14, 15}}}},
 
 
 
         {{{{16, 17},
            {18, 19}},
 
           {{20, 21},
            {22, 23}}}}};
      inline int bias[3] = {0,1,2};
      inline int groups = 3;
      inline auto groups_ct = 3_ct;
      NMTOOLS_CAST_ARRAYS(input)
      NMTOOLS_CAST_ARRAYS(weight)
      NMTOOLS_CAST_ARRAYS(bias)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case1g)
    {
      inline int result[1][3][3][3][3] =
      {{{{{  440,   468,   496},
          {  552,   580,   608},
          {  664,   692,   720}},

          {{  888,   916,   944},
          { 1000,  1028,  1056},
          { 1112,  1140,  1168}},

          {{ 1336,  1364,  1392},
          { 1448,  1476,  1504},
          { 1560,  1588,  1616}}},


        {{{ 7001,  7093,  7185},
          { 7369,  7461,  7553},
          { 7737,  7829,  7921}},

          {{ 8473,  8565,  8657},
          { 8841,  8933,  9025},
          { 9209,  9301,  9393}},

          {{ 9945, 10037, 10129},
          {10313, 10405, 10497},
          {10681, 10773, 10865}}},


        {{{21754, 21910, 22066},
          {22378, 22534, 22690},
          {23002, 23158, 23314}},

          {{24250, 24406, 24562},
          {24874, 25030, 25186},
          {25498, 25654, 25810}},

          {{26746, 26902, 27058},
          {27370, 27526, 27682},
          {27994, 28150, 28306}}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case1h)
    {
      inline int input[1][3][4][4][4] =
        {{{{{  0,   1,   2,   3},
            {  4,   5,   6,   7},
            {  8,   9,  10,  11},
            { 12,  13,  14,  15}},
 
           {{ 16,  17,  18,  19},
            { 20,  21,  22,  23},
            { 24,  25,  26,  27},
            { 28,  29,  30,  31}},
 
           {{ 32,  33,  34,  35},
            { 36,  37,  38,  39},
            { 40,  41,  42,  43},
            { 44,  45,  46,  47}},
 
           {{ 48,  49,  50,  51},
            { 52,  53,  54,  55},
            { 56,  57,  58,  59},
            { 60,  61,  62,  63}}},
 
 
          {{{ 64,  65,  66,  67},
            { 68,  69,  70,  71},
            { 72,  73,  74,  75},
            { 76,  77,  78,  79}},
 
           {{ 80,  81,  82,  83},
            { 84,  85,  86,  87},
            { 88,  89,  90,  91},
            { 92,  93,  94,  95}},
 
           {{ 96,  97,  98,  99},
            {100, 101, 102, 103},
            {104, 105, 106, 107},
            {108, 109, 110, 111}},
 
           {{112, 113, 114, 115},
            {116, 117, 118, 119},
            {120, 121, 122, 123},
            {124, 125, 126, 127}}},
 
 
          {{{128, 129, 130, 131},
            {132, 133, 134, 135},
            {136, 137, 138, 139},
            {140, 141, 142, 143}},
 
           {{144, 145, 146, 147},
            {148, 149, 150, 151},
            {152, 153, 154, 155},
            {156, 157, 158, 159}},
 
           {{160, 161, 162, 163},
            {164, 165, 166, 167},
            {168, 169, 170, 171},
            {172, 173, 174, 175}},
 
           {{176, 177, 178, 179},
            {180, 181, 182, 183},
            {184, 185, 186, 187},
            {188, 189, 190, 191}}}}};
      
      inline int weight[6][1][2][2][2] =
        {{{{{ 0,  1},
            { 2,  3}},
 
           {{ 4,  5},
            { 6,  7}}}},
 
 
 
         {{{{ 8,  9},
            {10, 11}},
 
           {{12, 13},
            {14, 15}}}},
 
 
 
         {{{{16, 17},
            {18, 19}},
 
           {{20, 21},
            {22, 23}}}},
 
 
 
         {{{{24, 25},
            {26, 27}},
 
           {{28, 29},
            {30, 31}}}},
 
 
 
         {{{{32, 33},
            {34, 35}},
 
           {{36, 37},
            {38, 39}}}},
 
 
 
         {{{{40, 41},
            {42, 43}},
 
           {{44, 45},
            {46, 47}}}}};
      
      inline int bias[6] = {0,1,2,3,4,5};
      inline int groups = 3;
      inline int stride = 2;
      inline auto groups_ct = 3_ct;
      inline auto stride_ct = 2_ct;
      NMTOOLS_CAST_ARRAYS(input)
      NMTOOLS_CAST_ARRAYS(weight)
      NMTOOLS_CAST_ARRAYS(bias)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case1h)
    {
      inline int result[1][6][2][2][2] =
      {{{{{  440,   496},
          {  664,   720}},

          {{ 1336,  1392},
          { 1560,  1616}}},


        {{{ 1113,  1297},
          { 1849,  2033}},

          {{ 4057,  4241},
          { 4793,  4977}}},


        {{{11770, 12082},
          {13018, 13330}},

          {{16762, 17074},
          {18010, 18322}}},


        {{{16539, 16979},
          {18299, 18739}},

          {{23579, 24019},
          {25339, 25779}}},


        {{{39484, 40052},
          {41756, 42324}},

          {{48572, 49140},
          {50844, 51412}}},


        {{{48349, 49045},
          {51133, 51829}},

          {{59485, 60181},
          {62269, 62965}}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case1i)
    {
      inline int input[1][3][4][4][4] =
        {{{{{  0,   1,   2,   3},
            {  4,   5,   6,   7},
            {  8,   9,  10,  11},
            { 12,  13,  14,  15}},
 
           {{ 16,  17,  18,  19},
            { 20,  21,  22,  23},
            { 24,  25,  26,  27},
            { 28,  29,  30,  31}},
 
           {{ 32,  33,  34,  35},
            { 36,  37,  38,  39},
            { 40,  41,  42,  43},
            { 44,  45,  46,  47}},
 
           {{ 48,  49,  50,  51},
            { 52,  53,  54,  55},
            { 56,  57,  58,  59},
            { 60,  61,  62,  63}}},
 
 
          {{{ 64,  65,  66,  67},
            { 68,  69,  70,  71},
            { 72,  73,  74,  75},
            { 76,  77,  78,  79}},
 
           {{ 80,  81,  82,  83},
            { 84,  85,  86,  87},
            { 88,  89,  90,  91},
            { 92,  93,  94,  95}},
 
           {{ 96,  97,  98,  99},
            {100, 101, 102, 103},
            {104, 105, 106, 107},
            {108, 109, 110, 111}},
 
           {{112, 113, 114, 115},
            {116, 117, 118, 119},
            {120, 121, 122, 123},
            {124, 125, 126, 127}}},
 
 
          {{{128, 129, 130, 131},
            {132, 133, 134, 135},
            {136, 137, 138, 139},
            {140, 141, 142, 143}},
 
           {{144, 145, 146, 147},
            {148, 149, 150, 151},
            {152, 153, 154, 155},
            {156, 157, 158, 159}},
 
           {{160, 161, 162, 163},
            {164, 165, 166, 167},
            {168, 169, 170, 171},
            {172, 173, 174, 175}},
 
           {{176, 177, 178, 179},
            {180, 181, 182, 183},
            {184, 185, 186, 187},
            {188, 189, 190, 191}}}}};
      
      inline int weight[6][1][2][2][2] =
        {{{{{ 0,  1},
            { 2,  3}},
 
           {{ 4,  5},
            { 6,  7}}}},
 
 
 
         {{{{ 8,  9},
            {10, 11}},
 
           {{12, 13},
            {14, 15}}}},
 
 
 
         {{{{16, 17},
            {18, 19}},
 
           {{20, 21},
            {22, 23}}}},
 
 
 
         {{{{24, 25},
            {26, 27}},
 
           {{28, 29},
            {30, 31}}}},
 
 
 
         {{{{32, 33},
            {34, 35}},
 
           {{36, 37},
            {38, 39}}}},
 
 
 
         {{{{40, 41},
            {42, 43}},
 
           {{44, 45},
            {46, 47}}}}};
      
      inline int bias[6] = {0,1,2,3,4,5};
      inline int groups = 3;
      inline int stride[3] = {1,3,2};
      inline auto groups_ct = 3_ct;
      inline auto stride_ct = nmtools_tuple{1_ct,3_ct,2_ct};
      NMTOOLS_CAST_ARRAYS(input)
      NMTOOLS_CAST_ARRAYS(weight)
      NMTOOLS_CAST_ARRAYS(bias)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case1i)
    {
      inline int result[1][6][3][1][2] =
      {{{{{  440,   496}},
 
           {{  888,   944}},
 
           {{ 1336,  1392}}},
 
 
          {{{ 1113,  1297}},
 
           {{ 2585,  2769}},
 
           {{ 4057,  4241}}},
 
 
          {{{11770, 12082}},
 
           {{14266, 14578}},
 
           {{16762, 17074}}},
 
 
          {{{16539, 16979}},
 
           {{20059, 20499}},
 
           {{23579, 24019}}},
 
 
          {{{39484, 40052}},
 
           {{44028, 44596}},
 
           {{48572, 49140}}},
 
 
          {{{48349, 49045}},
 
           {{53917, 54613}},
 
           {{59485, 60181}}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case1j)
    {
      inline int input[1][3][4][4][4] =
        {{{{{  0,   1,   2,   3},
            {  4,   5,   6,   7},
            {  8,   9,  10,  11},
            { 12,  13,  14,  15}},
 
           {{ 16,  17,  18,  19},
            { 20,  21,  22,  23},
            { 24,  25,  26,  27},
            { 28,  29,  30,  31}},
 
           {{ 32,  33,  34,  35},
            { 36,  37,  38,  39},
            { 40,  41,  42,  43},
            { 44,  45,  46,  47}},
 
           {{ 48,  49,  50,  51},
            { 52,  53,  54,  55},
            { 56,  57,  58,  59},
            { 60,  61,  62,  63}}},
 
 
          {{{ 64,  65,  66,  67},
            { 68,  69,  70,  71},
            { 72,  73,  74,  75},
            { 76,  77,  78,  79}},
 
           {{ 80,  81,  82,  83},
            { 84,  85,  86,  87},
            { 88,  89,  90,  91},
            { 92,  93,  94,  95}},
 
           {{ 96,  97,  98,  99},
            {100, 101, 102, 103},
            {104, 105, 106, 107},
            {108, 109, 110, 111}},
 
           {{112, 113, 114, 115},
            {116, 117, 118, 119},
            {120, 121, 122, 123},
            {124, 125, 126, 127}}},
 
 
          {{{128, 129, 130, 131},
            {132, 133, 134, 135},
            {136, 137, 138, 139},
            {140, 141, 142, 143}},
 
           {{144, 145, 146, 147},
            {148, 149, 150, 151},
            {152, 153, 154, 155},
            {156, 157, 158, 159}},
 
           {{160, 161, 162, 163},
            {164, 165, 166, 167},
            {168, 169, 170, 171},
            {172, 173, 174, 175}},
 
           {{176, 177, 178, 179},
            {180, 181, 182, 183},
            {184, 185, 186, 187},
            {188, 189, 190, 191}}}}};
      
      inline int weight[6][1][2][2][2] =
        {{{{{ 0,  1},
            { 2,  3}},
 
           {{ 4,  5},
            { 6,  7}}}},
 
 
 
         {{{{ 8,  9},
            {10, 11}},
 
           {{12, 13},
            {14, 15}}}},
 
 
 
         {{{{16, 17},
            {18, 19}},
 
           {{20, 21},
            {22, 23}}}},
 
 
 
         {{{{24, 25},
            {26, 27}},
 
           {{28, 29},
            {30, 31}}}},
 
 
 
         {{{{32, 33},
            {34, 35}},
 
           {{36, 37},
            {38, 39}}}},
 
 
 
         {{{{40, 41},
            {42, 43}},
 
           {{44, 45},
            {46, 47}}}}};
      
      inline int bias[6] = {0,1,2,3,4,5};
      inline int groups = 3;
      inline int stride[3] = {1,3,2};
      inline int padding[3] = {1,0,1};
      inline auto groups_ct = 3_ct;
      inline auto stride_ct = nmtools_tuple{1_ct,3_ct,2_ct};
      inline auto padding_ct = nmtools_tuple{1_ct,0_ct,1_ct};
      NMTOOLS_CAST_ARRAYS(input)
      NMTOOLS_CAST_ARRAYS(weight)
      NMTOOLS_CAST_ARRAYS(bias)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case1j)
    {
      inline int result[1][6][5][1][3] =
      {{{{{   28,    86,    54}},
 
          {{  232,   468,   228}},

          {{  488,   916,   420}},

          {{  744,  1364,   612}},

          {{  204,   318,   110}}},


        {{{   61,   199,   135}},

          {{  553,  1205,   645}},

          {{ 1321,  2677,  1349}},

          {{ 2089,  4149,  2053}},

          {{ 1005,  1967,   959}}},


        {{{ 2910,  5816,  2904}},

          {{ 5994, 11926,  5926}},

          {{ 7274, 14422,  7142}},

          {{ 8554, 16918,  8358}},

          {{ 4110,  8096,  3984}}},


        {{{ 3967,  7977,  4009}},

          {{ 8363, 16759,  8391}},

          {{10155, 20279, 10119}},

          {{11947, 23799, 11847}},

          {{ 5935, 11793,  5857}}},


        {{{ 9888, 19738,  9850}},

          {{19948, 39768, 19816}},

          {{22252, 44312, 22056}},

          {{24556, 48856, 24296}},

          {{12112, 24066, 11954}}},


        {{{11969, 23947, 11979}},

          {{24365, 48697, 24329}},

          {{27181, 54265, 27081}},

          {{29997, 59833, 29833}},

          {{14961, 29811, 14851}}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case1k)
    {
      inline int input[1][3][4][4][4] =
        {{{{{  0,   1,   2,   3},
            {  4,   5,   6,   7},
            {  8,   9,  10,  11},
            { 12,  13,  14,  15}},
 
           {{ 16,  17,  18,  19},
            { 20,  21,  22,  23},
            { 24,  25,  26,  27},
            { 28,  29,  30,  31}},
 
           {{ 32,  33,  34,  35},
            { 36,  37,  38,  39},
            { 40,  41,  42,  43},
            { 44,  45,  46,  47}},
 
           {{ 48,  49,  50,  51},
            { 52,  53,  54,  55},
            { 56,  57,  58,  59},
            { 60,  61,  62,  63}}},
 
 
          {{{ 64,  65,  66,  67},
            { 68,  69,  70,  71},
            { 72,  73,  74,  75},
            { 76,  77,  78,  79}},
 
           {{ 80,  81,  82,  83},
            { 84,  85,  86,  87},
            { 88,  89,  90,  91},
            { 92,  93,  94,  95}},
 
           {{ 96,  97,  98,  99},
            {100, 101, 102, 103},
            {104, 105, 106, 107},
            {108, 109, 110, 111}},
 
           {{112, 113, 114, 115},
            {116, 117, 118, 119},
            {120, 121, 122, 123},
            {124, 125, 126, 127}}},
 
 
          {{{128, 129, 130, 131},
            {132, 133, 134, 135},
            {136, 137, 138, 139},
            {140, 141, 142, 143}},
 
           {{144, 145, 146, 147},
            {148, 149, 150, 151},
            {152, 153, 154, 155},
            {156, 157, 158, 159}},
 
           {{160, 161, 162, 163},
            {164, 165, 166, 167},
            {168, 169, 170, 171},
            {172, 173, 174, 175}},
 
           {{176, 177, 178, 179},
            {180, 181, 182, 183},
            {184, 185, 186, 187},
            {188, 189, 190, 191}}}}};
      
      inline int weight[6][1][2][2][2] =
        {{{{{ 0,  1},
            { 2,  3}},
 
           {{ 4,  5},
            { 6,  7}}}},
 
 
 
         {{{{ 8,  9},
            {10, 11}},
 
           {{12, 13},
            {14, 15}}}},
 
 
 
         {{{{16, 17},
            {18, 19}},
 
           {{20, 21},
            {22, 23}}}},
 
 
 
         {{{{24, 25},
            {26, 27}},
 
           {{28, 29},
            {30, 31}}}},
 
 
 
         {{{{32, 33},
            {34, 35}},
 
           {{36, 37},
            {38, 39}}}},
 
 
 
         {{{{40, 41},
            {42, 43}},
 
           {{44, 45},
            {46, 47}}}}};
      
      inline int bias[6] = {0,1,2,3,4,5};
      inline int groups = 3;
      inline int stride[3] = {1,3,2};
      inline int padding[3] = {1,0,1};
      inline int dilation[3] = {2,1,2};
      inline auto groups_ct = 3_ct;
      inline auto stride_ct = nmtools_tuple{1_ct,3_ct,2_ct};
      inline auto padding_ct = nmtools_tuple{1_ct,0_ct,1_ct};
      inline auto dilation_ct = nmtools_tuple{2_ct,1_ct,2_ct};
      NMTOOLS_CAST_ARRAYS(input)
      NMTOOLS_CAST_ARRAYS(weight)
      NMTOOLS_CAST_ARRAYS(bias)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case1k)
    {
      inline int result[1][6][4][1][2] =
      {{{{{  232,   450}},
 
           {{  440,   836}},
 
           {{  696,  1284}},
 
           {{  144,   226}}},
 
 
          {{{  537,  1091}},
 
           {{ 1049,  2117}},
 
           {{ 1817,  3589}},
 
           {{  705,  1379}}},
 
 
          {{{ 3658,  7236}},
 
           {{ 6778, 13382}},
 
           {{ 8058, 15878}},
 
           {{ 3570,  7012}}},
 
 
          {{{ 4987,  9925}},
 
           {{ 9435, 18759}},
 
           {{11227, 22279}},
 
           {{ 5155, 10213}}},
 
 
          {{{11180, 22214}},
 
           {{21308, 42312}},
 
           {{23612, 46856}},
 
           {{11092, 21990}}},
 
 
          {{{13533, 26951}},
 
           {{26013, 51785}},
 
           {{28829, 57353}},
 
           {{13701, 27239}}}}};
    }
}

#endif // NMTOOLS_TESTING_DATA_ARRAY_CONV3D_HPP