#ifndef NMTOOLS_TESTING_DATA_ARRAY_KRON_HPP
#define NMTOOLS_TESTING_DATA_ARRAY_KRON_HPP

#include "nmtools/testing/testing.hpp"
#include "nmtools/testing/array_cast.hpp"

NMTOOLS_TESTING_DECLARE_CASE(array,kron)
{
    NMTOOLS_TESTING_DECLARE_ARGS(case1a)
    {
        inline int a[6] = {0,1,2,3,4,5};
        inline int b[3] = {0,1,2};

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case1a)
    {
        inline int result[18] = {0,0,0,0,1,2,0,2,4,0,3,6,0,4,8,0,5,10};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case1b)
    {
        inline int a[6] = {0,1,2,3,4,5};
        inline int b[3][4] = {
            {0,1, 2, 3},
            {4,5, 6, 7},
            {8,9,10,11},
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case1b)
    {
        inline int result[3][24] = {{ 0,  0,  0,  0,  0,  1,  2,  3,  0,  2,  4,  6,  0,  3,  6,  9,
          0,  4,  8, 12,  0,  5, 10, 15},
        { 0,  0,  0,  0,  4,  5,  6,  7,  8, 10, 12, 14, 12, 15, 18, 21,
         16, 20, 24, 28, 20, 25, 30, 35},
        { 0,  0,  0,  0,  8,  9, 10, 11, 16, 18, 20, 22, 24, 27, 30, 33,
         32, 36, 40, 44, 40, 45, 50, 55}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case1c)
    {
        inline int a[6] = {0,1,2,3,4,5};
        inline int b[2][3][2] = {
            {
                {0,1},
                {2,3},
                {4,5},
            },
            {
                { 6, 7},
                { 8, 9},
                {10,11},
            },
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case1c)
    {
        inline int result[2][3][12] =
        {{{ 0,  0,  0,  1,  0,  2,  0,  3,  0,  4,  0,  5},
          { 0,  0,  2,  3,  4,  6,  6,  9,  8, 12, 10, 15},
          { 0,  0,  4,  5,  8, 10, 12, 15, 16, 20, 20, 25}},
 
        {{ 0,  0,  6,  7, 12, 14, 18, 21, 24, 28, 30, 35},
         { 0,  0,  8,  9, 16, 18, 24, 27, 32, 36, 40, 45},
         { 0,  0, 10, 11, 20, 22, 30, 33, 40, 44, 50, 55}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case1d)
    {
        inline int a[6] = {0,1,2,3,4,5};
        inline int b[2][1][3][2] = {
            {
                {
                    {0,1},
                    {2,3},
                    {4,5},
                }
            },
            {
                {
                    { 6, 7},
                    { 8, 9},
                    {10,11},
                }
            },
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case1d)
    {
        inline int result[2][1][3][12] =
        {{{{ 0,  0,  0,  1,  0,  2,  0,  3,  0,  4,  0,  5},
           { 0,  0,  2,  3,  4,  6,  6,  9,  8, 12, 10, 15},
           { 0,  0,  4,  5,  8, 10, 12, 15, 16, 20, 20, 25}}},
 
 
        {{{ 0,  0,  6,  7, 12, 14, 18, 21, 24, 28, 30, 35},
          { 0,  0,  8,  9, 16, 18, 24, 27, 32, 36, 40, 45},
          { 0,  0, 10, 11, 20, 22, 30, 33, 40, 44, 50, 55}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case1e)
    {
        inline int a[6] = {0,1,2,3,4,5};
        inline int b[2][1][3][1][2] = {
            {
                {
                    {
                        {0,1},
                    },
                    {
                        {2,3},
                    },
                    {
                        {4,5},
                    },
                }
            },
            {
                {
                    {
                        {6,7},
                    },
                    {
                        {8,9},
                    },
                    {
                        {10,11},
                    },
                }
            },
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case1e)
    {
        inline int result[2][1][3][1][12] =
        {{{{{ 0,  0,  0,  1,  0,  2,  0,  3,  0,  4,  0,  5}},
 
           {{ 0,  0,  2,  3,  4,  6,  6,  9,  8, 12, 10, 15}},

           {{ 0,  0,  4,  5,  8, 10, 12, 15, 16, 20, 20, 25}}}},
 
 
 
        {{{{ 0,  0,  6,  7, 12, 14, 18, 21, 24, 28, 30, 35}},
 
          {{ 0,  0,  8,  9, 16, 18, 24, 27, 32, 36, 40, 45}},
 
          {{ 0,  0, 10, 11, 20, 22, 30, 33, 40, 44, 50, 55}}}}}
        ;
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case2a)
    {
        inline int a[3][2] = {
            {0,1},
            {2,3},
            {4,5},
        };
        inline int b[2][3] = {
            {0,1,2},
            {3,4,5},
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case2a)
    {
        inline int result[6][6] =
        {{ 0,  0,  0,  0,  1,  2},
         { 0,  0,  0,  3,  4,  5},
         { 0,  2,  4,  0,  3,  6},
         { 6,  8, 10,  9, 12, 15},
         { 0,  4,  8,  0,  5, 10},
         {12, 16, 20, 15, 20, 25}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case2b)
    {
        inline int a[2][3] = {
            {0,1,2},
            {3,4,5},
        };
        inline int b[3][2] = {
            {0,1},
            {2,3},
            {4,5},
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case2b)
    {
        inline int result[6][6] =
        {{ 0,  0,  0,  1,  0,  2},
         { 0,  0,  2,  3,  4,  6},
         { 0,  0,  4,  5,  8, 10},
         { 0,  3,  0,  4,  0,  5},
         { 6,  9,  8, 12, 10, 15},
         {12, 15, 16, 20, 20, 25}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case2c)
    {
        inline int a[3][2] = {
            {0,1},
            {2,3},
            {4,5},
        };
        inline int b[6] = {0,1,2,3,4,5};

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case2c)
    {
        inline int result[3][12] =
        {{ 0,  0,  0,  0,  0,  0,  0,  1,  2,  3,  4,  5},
         { 0,  2,  4,  6,  8, 10,  0,  3,  6,  9, 12, 15},
         { 0,  4,  8, 12, 16, 20,  0,  5, 10, 15, 20, 25}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case2d)
    {
        inline int a[3][4] = {
            {0,1, 2, 3},
            {4,5, 6, 7},
            {8,9,10,11},
        };
        inline int b[2][3][2] = {
            {
                {0,1},
                {2,3},
                {4,5},
            },
            {
                { 6, 7},
                { 8, 9},
                {10,11},
            },
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case2d)
    {
        inline int result[2][9][8] =
        {{{  0,   0,   0,   1,   0,   2,   0,   3},
          {  0,   0,   2,   3,   4,   6,   6,   9},
          {  0,   0,   4,   5,   8,  10,  12,  15},
          {  0,   4,   0,   5,   0,   6,   0,   7},
          {  8,  12,  10,  15,  12,  18,  14,  21},
          { 16,  20,  20,  25,  24,  30,  28,  35},
          {  0,   8,   0,   9,   0,  10,   0,  11},
          { 16,  24,  18,  27,  20,  30,  22,  33},
          { 32,  40,  36,  45,  40,  50,  44,  55}},
 
         {{  0,   0,   6,   7,  12,  14,  18,  21},
          {  0,   0,   8,   9,  16,  18,  24,  27},
          {  0,   0,  10,  11,  20,  22,  30,  33},
          { 24,  28,  30,  35,  36,  42,  42,  49},
          { 32,  36,  40,  45,  48,  54,  56,  63},
          { 40,  44,  50,  55,  60,  66,  70,  77},
          { 48,  56,  54,  63,  60,  70,  66,  77},
          { 64,  72,  72,  81,  80,  90,  88,  99},
          { 80,  88,  90,  99, 100, 110, 110, 121}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case2e)
    {
        inline int a[3][4] = {
            {0,1, 2, 3},
            {4,5, 6, 7},
            {8,9,10,11},
        };
        inline int b[2][1][3][2] = {
            {
                {
                    {0,1},
                    {2,3},
                    {4,5},
                }
            },
            {
                {
                    { 6, 7},
                    { 8, 9},
                    {10,11},
                }
            },
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case2e)
    {
        inline int result[2][1][9][8] =
        {{{{  0,   0,   0,   1,   0,   2,   0,   3},
           {  0,   0,   2,   3,   4,   6,   6,   9},
           {  0,   0,   4,   5,   8,  10,  12,  15},
           {  0,   4,   0,   5,   0,   6,   0,   7},
           {  8,  12,  10,  15,  12,  18,  14,  21},
           { 16,  20,  20,  25,  24,  30,  28,  35},
           {  0,   8,   0,   9,   0,  10,   0,  11},
           { 16,  24,  18,  27,  20,  30,  22,  33},
           { 32,  40,  36,  45,  40,  50,  44,  55}}},
 
 
         {{{  0,   0,   6,   7,  12,  14,  18,  21},
           {  0,   0,   8,   9,  16,  18,  24,  27},
           {  0,   0,  10,  11,  20,  22,  30,  33},
           { 24,  28,  30,  35,  36,  42,  42,  49},
           { 32,  36,  40,  45,  48,  54,  56,  63},
           { 40,  44,  50,  55,  60,  66,  70,  77},
           { 48,  56,  54,  63,  60,  70,  66,  77},
           { 64,  72,  72,  81,  80,  90,  88,  99},
           { 80,  88,  90,  99, 100, 110, 110, 121}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case2f)
    {
        inline int a[3][4] = {
            {0,1, 2, 3},
            {4,5, 6, 7},
            {8,9,10,11},
        };
        inline int b[2][1][3][1][2] = {
            {
                {
                    {
                        {0,1},
                    },
                    {
                        {2,3},
                    },
                    {
                        {4,5},
                    },
                }
            },
            {
                {
                    {
                        {6,7},
                    },
                    {
                        {8,9},
                    },
                    {
                        {10,11},
                    },
                }
            },
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case2f)
    {
        inline int result[2][1][3][3][8] =
        {{{{{  0,   0,   0,   1,   0,   2,   0,   3},
            {  0,   4,   0,   5,   0,   6,   0,   7},
            {  0,   8,   0,   9,   0,  10,   0,  11}},

           {{  0,   0,   2,   3,   4,   6,   6,   9},
            {  8,  12,  10,  15,  12,  18,  14,  21},
            { 16,  24,  18,  27,  20,  30,  22,  33}},

           {{  0,   0,   4,   5,   8,  10,  12,  15},
            { 16,  20,  20,  25,  24,  30,  28,  35},
            { 32,  40,  36,  45,  40,  50,  44,  55}}}},
 
 
 
         {{{{  0,   0,   6,   7,  12,  14,  18,  21},
            { 24,  28,  30,  35,  36,  42,  42,  49},
            { 48,  56,  54,  63,  60,  70,  66,  77}},

           {{  0,   0,   8,   9,  16,  18,  24,  27},
            { 32,  36,  40,  45,  48,  54,  56,  63},
            { 64,  72,  72,  81,  80,  90,  88,  99}},

           {{  0,   0,  10,  11,  20,  22,  30,  33},
            { 40,  44,  50,  55,  60,  66,  70,  77},
            { 80,  88,  90,  99, 100, 110, 110, 121}}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case2g)
    {
        inline int a[3][4] = {
            {0,1, 2, 3},
            {4,5, 6, 7},
            {8,9,10,11},
        };
        inline int b[2][1][3][1][2][1] = {
            {
                {
                    {
                        {
                            {0},
                            {1},
                        }
                    },
                    {
                        {
                            {2},
                            {3},
                        }
                    },
                    {
                        {
                            {4},
                            {5},
                        }
                    },
                }
            },
            {
                {
                    {
                        {
                            {6},
                            {7},
                        }
                    },
                    {
                        {
                            {8},
                            {9},
                        }
                    },
                    {
                        {
                            {10},
                            {11},
                        }
                    },
                }
            },
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case2g)
    {
        inline int result[2][1][3][1][6][4] =
        {{{{{{  0,   0,   0,   0},
             {  0,   1,   2,   3},
             {  0,   0,   0,   0},
             {  4,   5,   6,   7},
             {  0,   0,   0,   0},
             {  8,   9,  10,  11}}},
 
 
           {{{  0,   2,   4,   6},
             {  0,   3,   6,   9},
             {  8,  10,  12,  14},
             { 12,  15,  18,  21},
             { 16,  18,  20,  22},
             { 24,  27,  30,  33}}},
 
 
           {{{  0,   4,   8,  12},
             {  0,   5,  10,  15},
             { 16,  20,  24,  28},
             { 20,  25,  30,  35},
             { 32,  36,  40,  44},
             { 40,  45,  50,  55}}}}},
 
 
 
 
         {{{{{  0,   6,  12,  18},
             {  0,   7,  14,  21},
             { 24,  30,  36,  42},
             { 28,  35,  42,  49},
             { 48,  54,  60,  66},
             { 56,  63,  70,  77}}},
 
 
           {{{  0,   8,  16,  24},
             {  0,   9,  18,  27},
             { 32,  40,  48,  56},
             { 36,  45,  54,  63},
             { 64,  72,  80,  88},
             { 72,  81,  90,  99}}},
 
 
           {{{  0,  10,  20,  30},
             {  0,  11,  22,  33},
             { 40,  50,  60,  70},
             { 44,  55,  66,  77},
             { 80,  90, 100, 110},
             { 88,  99, 110, 121}}}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case2h)
    {
        inline int a[3][4] = {
            {0,1, 2, 3},
            {4,5, 6, 7},
            {8,9,10,11},
        };
        inline int b[2][1][1][3][1][2][1] = {
            {
                {
                    {
                        {
                            {
                                {0},
                                {1},
                            }
                        },
                        {
                            {
                                {2},
                                {3},
                            }
                        },
                        {
                            {
                                {4},
                                {5},
                            }
                        },
                    }
                }
            },
            {
                {
                    {
                        {
                            {
                                {6},
                                {7},
                            }
                        },
                        {
                            {
                                {8},
                                {9},
                            }
                        },
                        {
                            {
                                {10},
                                {11},
                            }
                        },
                    }
                }
            },
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case2h)
    {
        inline int result[2][1][1][3][1][6][4] =
        {{{{{{{  0,   0,   0,   0},
              {  0,   1,   2,   3},
              {  0,   0,   0,   0},
              {  4,   5,   6,   7},
              {  0,   0,   0,   0},
              {  8,   9,  10,  11}}},
 
 
            {{{  0,   2,   4,   6},
              {  0,   3,   6,   9},
              {  8,  10,  12,  14},
              { 12,  15,  18,  21},
              { 16,  18,  20,  22},
              { 24,  27,  30,  33}}},
 
 
            {{{  0,   4,   8,  12},
              {  0,   5,  10,  15},
              { 16,  20,  24,  28},
              { 20,  25,  30,  35},
              { 32,  36,  40,  44},
              { 40,  45,  50,  55}}}}}},
 
 
 
 
 
         {{{{{{  0,   6,  12,  18},
              {  0,   7,  14,  21},
              { 24,  30,  36,  42},
              { 28,  35,  42,  49},
              { 48,  54,  60,  66},
              { 56,  63,  70,  77}}},
 
 
            {{{  0,   8,  16,  24},
              {  0,   9,  18,  27},
              { 32,  40,  48,  56},
              { 36,  45,  54,  63},
              { 64,  72,  80,  88},
              { 72,  81,  90,  99}}},
 
 
            {{{  0,  10,  20,  30},
              {  0,  11,  22,  33},
              { 40,  50,  60,  70},
              { 44,  55,  66,  77},
              { 80,  90, 100, 110},
              { 88,  99, 110, 121}}}}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case3a)
    {
        inline int a[2][3][2] = {
            {
                {0,1},
                {2,3},
                {4,5},
            },
            {
                { 6, 7},
                { 8, 9},
                {10,11},
            },
        };
        inline int b[2][3][2] = {
            {
                {0,1},
                {2,3},
                {4,5},
            },
            {
                { 6, 7},
                { 8, 9},
                {10,11},
            },
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case3a)
    {
        inline int result[4][9][4] =
        {{{  0,   0,   0,   1},
          {  0,   0,   2,   3},
          {  0,   0,   4,   5},
          {  0,   2,   0,   3},
          {  4,   6,   6,   9},
          {  8,  10,  12,  15},
          {  0,   4,   0,   5},
          {  8,  12,  10,  15},
          { 16,  20,  20,  25}},
 
         {{  0,   0,   6,   7},
          {  0,   0,   8,   9},
          {  0,   0,  10,  11},
          { 12,  14,  18,  21},
          { 16,  18,  24,  27},
          { 20,  22,  30,  33},
          { 24,  28,  30,  35},
          { 32,  36,  40,  45},
          { 40,  44,  50,  55}},
 
         {{  0,   6,   0,   7},
          { 12,  18,  14,  21},
          { 24,  30,  28,  35},
          {  0,   8,   0,   9},
          { 16,  24,  18,  27},
          { 32,  40,  36,  45},
          {  0,  10,   0,  11},
          { 20,  30,  22,  33},
          { 40,  50,  44,  55}},
 
         {{ 36,  42,  42,  49},
          { 48,  54,  56,  63},
          { 60,  66,  70,  77},
          { 48,  56,  54,  63},
          { 64,  72,  72,  81},
          { 80,  88,  90,  99},
          { 60,  70,  66,  77},
          { 80,  90,  88,  99},
          {100, 110, 110, 121}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case3b)
    {
        inline int a[2][3][2] = {
            {
                {0,1},
                {2,3},
                {4,5},
            },
            {
                { 6, 7},
                { 8, 9},
                {10,11},
            },
        };
        inline int b[2][1][3] = {
            {
                {0,1,2},
            },
            {

                {3,4,5},
            },
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case3b)
    {
        inline int result[4][3][6] =
        {{{ 0,  0,  0,  0,  1,  2},
          { 0,  2,  4,  0,  3,  6},
          { 0,  4,  8,  0,  5, 10}},
 
         {{ 0,  0,  0,  3,  4,  5},
          { 6,  8, 10,  9, 12, 15},
          {12, 16, 20, 15, 20, 25}},
 
         {{ 0,  6, 12,  0,  7, 14},
          { 0,  8, 16,  0,  9, 18},
          { 0, 10, 20,  0, 11, 22}},
 
         {{18, 24, 30, 21, 28, 35},
          {24, 32, 40, 27, 36, 45},
          {30, 40, 50, 33, 44, 55}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case3c)
    {
        inline int a[2][3][2] = {
            {
                {0,1},
                {2,3},
                {4,5},
            },
            {
                { 6, 7},
                { 8, 9},
                {10,11},
            },
        };
        inline int b[3][4] = {
            {0,1, 2, 3},
            {4,5, 6, 7},
            {8,9,10,11},
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case3c)
    {
        inline int result[2][9][8] =
        {{{  0,   0,   0,   0,   0,   1,   2,   3},
          {  0,   0,   0,   0,   4,   5,   6,   7},
          {  0,   0,   0,   0,   8,   9,  10,  11},
          {  0,   2,   4,   6,   0,   3,   6,   9},
          {  8,  10,  12,  14,  12,  15,  18,  21},
          { 16,  18,  20,  22,  24,  27,  30,  33},
          {  0,   4,   8,  12,   0,   5,  10,  15},
          { 16,  20,  24,  28,  20,  25,  30,  35},
          { 32,  36,  40,  44,  40,  45,  50,  55}},
 
         {{  0,   6,  12,  18,   0,   7,  14,  21},
          { 24,  30,  36,  42,  28,  35,  42,  49},
          { 48,  54,  60,  66,  56,  63,  70,  77},
          {  0,   8,  16,  24,   0,   9,  18,  27},
          { 32,  40,  48,  56,  36,  45,  54,  63},
          { 64,  72,  80,  88,  72,  81,  90,  99},
          {  0,  10,  20,  30,   0,  11,  22,  33},
          { 40,  50,  60,  70,  44,  55,  66,  77},
          { 80,  90, 100, 110,  88,  99, 110, 121}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case3d)
    {
        inline int a[2][3][2] = {
            {
                {0,1},
                {2,3},
                {4,5},
            },
            {
                { 6, 7},
                { 8, 9},
                {10,11},
            }
        };
        inline int b[6] = {0,1,2,3,4,5};

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case3d)
    {
        inline int result[2][3][12] =
        {{{ 0,  0,  0,  0,  0,  0,  0,  1,  2,  3,  4,  5},
          { 0,  2,  4,  6,  8, 10,  0,  3,  6,  9, 12, 15},
          { 0,  4,  8, 12, 16, 20,  0,  5, 10, 15, 20, 25}},
 
         {{ 0,  6, 12, 18, 24, 30,  0,  7, 14, 21, 28, 35},
          { 0,  8, 16, 24, 32, 40,  0,  9, 18, 27, 36, 45},
          { 0, 10, 20, 30, 40, 50,  0, 11, 22, 33, 44, 55}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case3e)
    {
        inline int a[2][3][2] = {
            {
                {0,1},
                {2,3},
                {4,5},
            },
            {
                { 6, 7},
                { 8, 9},
                {10,11},
            },
        };
        inline int b[2][1][3][1] = {
            {
                {
                    {0},
                    {1},
                    {2}
                }
            },
            {
                {
                    {3},
                    {4},
                    {5},
                }
            },
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case3e)
    {
        inline int result[2][2][9][2] =
        {{{{ 0,  0},
           { 0,  1},
           { 0,  2},
           { 0,  0},
           { 2,  3},
           { 4,  6},
           { 0,  0},
           { 4,  5},
           { 8, 10}},
 
          {{ 0,  0},
           { 6,  7},
           {12, 14},
           { 0,  0},
           { 8,  9},
           {16, 18},
           { 0,  0},
           {10, 11},
           {20, 22}}},
 
 
         {{{ 0,  3},
           { 0,  4},
           { 0,  5},
           { 6,  9},
           { 8, 12},
           {10, 15},
           {12, 15},
           {16, 20},
           {20, 25}},
 
          {{18, 21},
           {24, 28},
           {30, 35},
           {24, 27},
           {32, 36},
           {40, 45},
           {30, 33},
           {40, 44},
           {50, 55}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case3f)
    {
        inline int a[2][3][2] = {
            {
                {0,1},
                {2,3},
                {4,5},
            },
            {
                { 6, 7},
                { 8, 9},
                {10,11},
            }
        };
        inline int b[2][1][2][3][1] = {
            {
                {
                    {
                        {0},
                        {1},
                        {2},
                    },
                    {
                        {3},
                        {4},
                        {5},
                    },
                }
            },
            {
                {
                    {
                        {6},
                        {7},
                        {8},
                    },
                    {
                        { 9},
                        {10},
                        {11},
                    },
                }
            },
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case3f)
    {
        inline int result[2][1][4][9][2] =
        {{{{{  0,   0},
            {  0,   1},
            {  0,   2},
            {  0,   0},
            {  2,   3},
            {  4,   6},
            {  0,   0},
            {  4,   5},
            {  8,  10}},
 
           {{  0,   3},
            {  0,   4},
            {  0,   5},
            {  6,   9},
            {  8,  12},
            { 10,  15},
            { 12,  15},
            { 16,  20},
            { 20,  25}},
 
           {{  0,   0},
            {  6,   7},
            { 12,  14},
            {  0,   0},
            {  8,   9},
            { 16,  18},
            {  0,   0},
            { 10,  11},
            { 20,  22}},
 
           {{ 18,  21},
            { 24,  28},
            { 30,  35},
            { 24,  27},
            { 32,  36},
            { 40,  45},
            { 30,  33},
            { 40,  44},
            { 50,  55}}}},
 
 
 
         {{{{  0,   6},
            {  0,   7},
            {  0,   8},
            { 12,  18},
            { 14,  21},
            { 16,  24},
            { 24,  30},
            { 28,  35},
            { 32,  40}},
 
           {{  0,   9},
            {  0,  10},
            {  0,  11},
            { 18,  27},
            { 20,  30},
            { 22,  33},
            { 36,  45},
            { 40,  50},
            { 44,  55}},
 
           {{ 36,  42},
            { 42,  49},
            { 48,  56},
            { 48,  54},
            { 56,  63},
            { 64,  72},
            { 60,  66},
            { 70,  77},
            { 80,  88}},
 
           {{ 54,  63},
            { 60,  70},
            { 66,  77},
            { 72,  81},
            { 80,  90},
            { 88,  99},
            { 90,  99},
            {100, 110},
            {110, 121}}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case3g)
    {
        inline int a[2][3][2] = {
            {
                {0,1},
                {2,3},
                {4,5},
            },
            {
                { 6, 7},
                { 8, 9},
                {10,11},
            },
        };
        inline int b[2][1][2][1][3][1] = {
            {
                {
                    {
                        {
                            {0},
                            {1},
                            {2},
                        }
                    },
                    {
                        {
                            {3},
                            {4},
                            {5},
                        }
                    },
                }
            },
            {
                {
                    {
                        {
                            {6},
                            {7},
                            {8},
                        }
                    },
                    {
                        {
                            { 9},
                            {10},
                            {11},
                        }
                    },
                }
            },
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case3g)
    {
        inline int result[2][1][2][2][9][2] =
        {{{{{{  0,   0},
             {  0,   1},
             {  0,   2},
             {  0,   0},
             {  2,   3},
             {  4,   6},
             {  0,   0},
             {  4,   5},
             {  8,  10}},
 
            {{  0,   0},
             {  6,   7},
             { 12,  14},
             {  0,   0},
             {  8,   9},
             { 16,  18},
             {  0,   0},
             { 10,  11},
             { 20,  22}}},
 
 
           {{{  0,   3},
             {  0,   4},
             {  0,   5},
             {  6,   9},
             {  8,  12},
             { 10,  15},
             { 12,  15},
             { 16,  20},
             { 20,  25}},
 
            {{ 18,  21},
             { 24,  28},
             { 30,  35},
             { 24,  27},
             { 32,  36},
             { 40,  45},
             { 30,  33},
             { 40,  44},
             { 50,  55}}}}},
 
 
 
 
         {{{{{  0,   6},
             {  0,   7},
             {  0,   8},
             { 12,  18},
             { 14,  21},
             { 16,  24},
             { 24,  30},
             { 28,  35},
             { 32,  40}},
 
            {{ 36,  42},
             { 42,  49},
             { 48,  56},
             { 48,  54},
             { 56,  63},
             { 64,  72},
             { 60,  66},
             { 70,  77},
             { 80,  88}}},
 
 
           {{{  0,   9},
             {  0,  10},
             {  0,  11},
             { 18,  27},
             { 20,  30},
             { 22,  33},
             { 36,  45},
             { 40,  50},
             { 44,  55}},
 
            {{ 54,  63},
             { 60,  70},
             { 66,  77},
             { 72,  81},
             { 80,  90},
             { 88,  99},
             { 90,  99},
             {100, 110},
             {110, 121}}}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case3h)
    {
        inline int a[2][3][2] = {
            {
                {0,1},
                {2,3},
                {4,5},
            },
            {
                { 6, 7},
                { 8, 9},
                {10,11},
            }
        };
        inline int b[2][1][1][3][1][2][1] = {
            {
                {
                    {
                        {
                            {
                                {0},
                                {1},
                            }
                        },
                        {
                            {
                                {2},
                                {3},
                            }
                        },
                        {
                            {
                                {4},
                                {5},
                            }
                        },
                    }
                }
            },
            {
                {
                    {
                        {
                            {
                                {6},
                                {7},
                            }
                        },
                        {
                            {
                                {8},
                                {9},
                            }
                        },
                        {
                            {
                                {10},
                                {11},
                            }
                        },
                    }
                }
            },
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case3h)
    {
        inline int result[2][1][1][3][2][6][2] =
        {{{{{{{  0,   0},
              {  0,   1},
              {  0,   0},
              {  2,   3},
              {  0,   0},
              {  4,   5}},
 
             {{  0,   0},
              {  6,   7},
              {  0,   0},
              {  8,   9},
              {  0,   0},
              { 10,  11}}},
 
 
            {{{  0,   2},
              {  0,   3},
              {  4,   6},
              {  6,   9},
              {  8,  10},
              { 12,  15}},
 
             {{ 12,  14},
              { 18,  21},
              { 16,  18},
              { 24,  27},
              { 20,  22},
              { 30,  33}}},
 
 
            {{{  0,   4},
              {  0,   5},
              {  8,  12},
              { 10,  15},
              { 16,  20},
              { 20,  25}},
 
             {{ 24,  28},
              { 30,  35},
              { 32,  36},
              { 40,  45},
              { 40,  44},
              { 50,  55}}}}}},
 
 
 
 
 
         {{{{{{  0,   6},
              {  0,   7},
              { 12,  18},
              { 14,  21},
              { 24,  30},
              { 28,  35}},
 
             {{ 36,  42},
              { 42,  49},
              { 48,  54},
              { 56,  63},
              { 60,  66},
              { 70,  77}}},
 
 
            {{{  0,   8},
              {  0,   9},
              { 16,  24},
              { 18,  27},
              { 32,  40},
              { 36,  45}},
 
             {{ 48,  56},
              { 54,  63},
              { 64,  72},
              { 72,  81},
              { 80,  88},
              { 90,  99}}},
 
 
            {{{  0,  10},
              {  0,  11},
              { 20,  30},
              { 22,  33},
              { 40,  50},
              { 44,  55}},
 
             {{ 60,  70},
              { 66,  77},
              { 80,  90},
              { 88,  99},
              {100, 110},
              {110, 121}}}}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case4a)
    {
        inline int a[2][1][3][2] = {
            {
                {
                    {0,1},
                    {2,3},
                    {4,5},
                }
            },
            {
                {
                    { 6, 7},
                    { 8, 9},
                    {10,11},
                }
            },
        };
        inline int b[2][2][3][1] = {
            {
                {
                    {0},
                    {1},
                    {2},
                },
                {
                    {3},
                    {4},
                    {5},
                },
            },
            {
                {
                    {6},
                    {7},
                    {8},
                },
                {
                    { 9},
                    {10},
                    {11},
                },
            },
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case4a)
    {
        inline int result[4][2][9][2] =
        {{{{  0,   0},
           {  0,   1},
           {  0,   2},
           {  0,   0},
           {  2,   3},
           {  4,   6},
           {  0,   0},
           {  4,   5},
           {  8,  10}},
 
          {{  0,   3},
           {  0,   4},
           {  0,   5},
           {  6,   9},
           {  8,  12},
           { 10,  15},
           { 12,  15},
           { 16,  20},
           { 20,  25}}},
 
 
         {{{  0,   6},
           {  0,   7},
           {  0,   8},
           { 12,  18},
           { 14,  21},
           { 16,  24},
           { 24,  30},
           { 28,  35},
           { 32,  40}},
 
          {{  0,   9},
           {  0,  10},
           {  0,  11},
           { 18,  27},
           { 20,  30},
           { 22,  33},
           { 36,  45},
           { 40,  50},
           { 44,  55}}},
 
 
         {{{  0,   0},
           {  6,   7},
           { 12,  14},
           {  0,   0},
           {  8,   9},
           { 16,  18},
           {  0,   0},
           { 10,  11},
           { 20,  22}},
 
          {{ 18,  21},
           { 24,  28},
           { 30,  35},
           { 24,  27},
           { 32,  36},
           { 40,  45},
           { 30,  33},
           { 40,  44},
           { 50,  55}}},
 
 
         {{{ 36,  42},
           { 42,  49},
           { 48,  56},
           { 48,  54},
           { 56,  63},
           { 64,  72},
           { 60,  66},
           { 70,  77},
           { 80,  88}},
 
          {{ 54,  63},
           { 60,  70},
           { 66,  77},
           { 72,  81},
           { 80,  90},
           { 88,  99},
           { 90,  99},
           {100, 110},
           {110, 121}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case4b)
    {
        inline int a[2][1][3][2] = {
            {
                {
                    {0,1},
                    {2,3},
                    {4,5},
                }
            },
            {
                {
                    { 6, 7},
                    { 8, 9},
                    {10,11},
                }
            },
        };
        inline int b[2][3][2] = {
            {
                {0,1},
                {2,3},
                {4,5},
            },
            {
                { 6, 7},
                { 8, 9},
                {10,11},
            }
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case4b)
    {
        inline int result[2][2][9][4] =
        {{{{  0,   0,   0,   1},
           {  0,   0,   2,   3},
           {  0,   0,   4,   5},
           {  0,   2,   0,   3},
           {  4,   6,   6,   9},
           {  8,  10,  12,  15},
           {  0,   4,   0,   5},
           {  8,  12,  10,  15},
           { 16,  20,  20,  25}},
 
          {{  0,   0,   6,   7},
           {  0,   0,   8,   9},
           {  0,   0,  10,  11},
           { 12,  14,  18,  21},
           { 16,  18,  24,  27},
           { 20,  22,  30,  33},
           { 24,  28,  30,  35},
           { 32,  36,  40,  45},
           { 40,  44,  50,  55}}},
 
 
         {{{  0,   6,   0,   7},
           { 12,  18,  14,  21},
           { 24,  30,  28,  35},
           {  0,   8,   0,   9},
           { 16,  24,  18,  27},
           { 32,  40,  36,  45},
           {  0,  10,   0,  11},
           { 20,  30,  22,  33},
           { 40,  50,  44,  55}},
 
          {{ 36,  42,  42,  49},
           { 48,  54,  56,  63},
           { 60,  66,  70,  77},
           { 48,  56,  54,  63},
           { 64,  72,  72,  81},
           { 80,  88,  90,  99},
           { 60,  70,  66,  77},
           { 80,  90,  88,  99},
           {100, 110, 110, 121}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case4c)
    {
        inline int a[2][1][3][2] = {
            {
                {
                    {0,1},
                    {2,3},
                    {4,5},
                }
            },
            {
                {
                    { 6, 7},
                    { 8, 9},
                    {10,11},
                }
            },
        };
        inline int b[3][2] = {
            {0,1},
            {2,3},
            {4,5},
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case4c)
    {
        inline int result[2][1][9][4] =
        {{{{ 0,  0,  0,  1},
           { 0,  0,  2,  3},
           { 0,  0,  4,  5},
           { 0,  2,  0,  3},
           { 4,  6,  6,  9},
           { 8, 10, 12, 15},
           { 0,  4,  0,  5},
           { 8, 12, 10, 15},
           {16, 20, 20, 25}}},
 
 
         {{{ 0,  6,  0,  7},
           {12, 18, 14, 21},
           {24, 30, 28, 35},
           { 0,  8,  0,  9},
           {16, 24, 18, 27},
           {32, 40, 36, 45},
           { 0, 10,  0, 11},
           {20, 30, 22, 33},
           {40, 50, 44, 55}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case4d)
    {
        inline int a[2][1][3][2] = {
            {
                {
                    {0,1},
                    {2,3},
                    {4,5},
                }
            },
            {
                {
                    { 6, 7},
                    { 8, 9},
                    {10,11},
                }
            },
        };
        inline int b[6] = {0,1,2,3,4,5};

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case4d)
    {
        inline int result[2][1][3][12] =
        {{{{ 0,  0,  0,  0,  0,  0,  0,  1,  2,  3,  4,  5},
           { 0,  2,  4,  6,  8, 10,  0,  3,  6,  9, 12, 15},
           { 0,  4,  8, 12, 16, 20,  0,  5, 10, 15, 20, 25}}},
 
 
         {{{ 0,  6, 12, 18, 24, 30,  0,  7, 14, 21, 28, 35},
           { 0,  8, 16, 24, 32, 40,  0,  9, 18, 27, 36, 45},
           { 0, 10, 20, 30, 40, 50,  0, 11, 22, 33, 44, 55}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case5a)
    {
        inline int a[2][1][3][1][2] = {
            {
                {
                    {
                        {0,1}
                    },
                    {
                        {2,3},
                    },
                    {
                        {4,5},
                    },
                }
            },
            {
                {
                    {
                        {6,7},
                    },
                    {
                        {8,9},
                    },
                    {
                        {10,11},
                    },
                }
            },
        };
        inline int b[2][2][1][3][1] = {
            {
                {
                    {
                        {0},
                        {1},
                        {2},
                    }
                },
                {
                    {
                        {3},
                        {4},
                        {5},
                    }
                },
            },
            {
                {
                    {
                        {6},
                        {7},
                        {8},
                    }
                },
                {
                    {
                        { 9},
                        {10},
                        {11},
                    }
                },
            },
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case5a)
    {
        inline int result[4][2][3][3][2] =
        {{{{{  0,   0},
            {  0,   1},
            {  0,   2}},
 
           {{  0,   0},
            {  2,   3},
            {  4,   6}},
 
           {{  0,   0},
            {  4,   5},
            {  8,  10}}},
 
 
          {{{  0,   3},
            {  0,   4},
            {  0,   5}},
 
           {{  6,   9},
            {  8,  12},
            { 10,  15}},
 
           {{ 12,  15},
            { 16,  20},
            { 20,  25}}}},
 
 
 
         {{{{  0,   6},
            {  0,   7},
            {  0,   8}},
 
           {{ 12,  18},
            { 14,  21},
            { 16,  24}},
 
           {{ 24,  30},
            { 28,  35},
            { 32,  40}}},
 
 
          {{{  0,   9},
            {  0,  10},
            {  0,  11}},
 
           {{ 18,  27},
            { 20,  30},
            { 22,  33}},
 
           {{ 36,  45},
            { 40,  50},
            { 44,  55}}}},
 
 
 
         {{{{  0,   0},
            {  6,   7},
            { 12,  14}},
 
           {{  0,   0},
            {  8,   9},
            { 16,  18}},
 
           {{  0,   0},
            { 10,  11},
            { 20,  22}}},
 
 
          {{{ 18,  21},
            { 24,  28},
            { 30,  35}},
 
           {{ 24,  27},
            { 32,  36},
            { 40,  45}},
 
           {{ 30,  33},
            { 40,  44},
            { 50,  55}}}},
 
 
 
         {{{{ 36,  42},
            { 42,  49},
            { 48,  56}},
 
           {{ 48,  54},
            { 56,  63},
            { 64,  72}},
 
           {{ 60,  66},
            { 70,  77},
            { 80,  88}}},
 
 
          {{{ 54,  63},
            { 60,  70},
            { 66,  77}},
 
           {{ 72,  81},
            { 80,  90},
            { 88,  99}},
 
           {{ 90,  99},
            {100, 110},
            {110, 121}}}}};
    }

    NMTOOLS_TESTING_DECLARE_ARGS(case6a)
    {
        inline int a[2][1][3][1][2][1] = {
            {
                {
                    {
                        {
                            {0},
                            {1},
                        }
                    },
                    {
                        {
                            {2},
                            {3},
                        }
                    },
                    {
                        {
                            {4},
                            {5},
                        }
                    },
                }
            },
            {
                {
                    {
                        {
                            {6},
                            {7},
                        }
                    },
                    {
                        {
                            {8},
                            {9},
                        }
                    },
                    {
                        {
                            {10},
                            {11},
                        }
                    },
                }
            },
        };
        inline int b[1][3][1][2][1][2] = {
            {
                {
                    {
                        {
                            {0,1},
                        },
                        {
                            {2,3},
                        },
                    }
                },
                {
                    {
                        {
                            {4,5},
                        },
                        {
                            {6,7},
                        }
                    }
                },
                {
                    {
                        {
                            {8,9},
                        },
                        {
                            {10,11},
                        }
                    }
                },
            }
        };

        NMTOOLS_CAST_ARRAYS(a)
        NMTOOLS_CAST_ARRAYS(b)
    }
    NMTOOLS_TESTING_DECLARE_EXPECT(case6a)
    {
        inline int result[2][3][3][2][2][2] =
        {{{{{{  0,   0},
             {  0,   1}},
 
            {{  0,   0},
             {  2,   3}}},
 
 
           {{{  0,   2},
             {  0,   3}},
 
            {{  4,   6},
             {  6,   9}}},
 
 
           {{{  0,   4},
             {  0,   5}},
 
            {{  8,  12},
             { 10,  15}}}},
 
 
 
          {{{{  0,   0},
             {  4,   5}},
 
            {{  0,   0},
             {  6,   7}}},
 
 
           {{{  8,  10},
             { 12,  15}},
 
            {{ 12,  14},
             { 18,  21}}},
 
 
           {{{ 16,  20},
             { 20,  25}},
 
            {{ 24,  28},
             { 30,  35}}}},
 
 
 
          {{{{  0,   0},
             {  8,   9}},
 
            {{  0,   0},
             { 10,  11}}},
 
 
           {{{ 16,  18},
             { 24,  27}},
 
            {{ 20,  22},
             { 30,  33}}},
 
 
           {{{ 32,  36},
             { 40,  45}},
 
            {{ 40,  44},
             { 50,  55}}}}},
 
 
 
 
         {{{{{  0,   6},
             {  0,   7}},
 
            {{ 12,  18},
             { 14,  21}}},
 
 
           {{{  0,   8},
             {  0,   9}},
 
            {{ 16,  24},
             { 18,  27}}},
 
 
           {{{  0,  10},
             {  0,  11}},
 
            {{ 20,  30},
             { 22,  33}}}},
 
 
 
          {{{{ 24,  30},
             { 28,  35}},
 
            {{ 36,  42},
             { 42,  49}}},
 
 
           {{{ 32,  40},
             { 36,  45}},
 
            {{ 48,  56},
             { 54,  63}}},
 
 
           {{{ 40,  50},
             { 44,  55}},
 
            {{ 60,  70},
             { 66,  77}}}},
 
 
 
          {{{{ 48,  54},
             { 56,  63}},
 
            {{ 60,  66},
             { 70,  77}}},
 
 
           {{{ 64,  72},
             { 72,  81}},
 
            {{ 80,  88},
             { 90,  99}}},
 
 
           {{{ 80,  90},
             { 88,  99}},
 
            {{100, 110},
             {110, 121}}}}}};
    }
}

#endif // NMTOOLS_TESTING_DATA_ARRAY_KRON_HPP